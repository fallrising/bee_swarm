# Git Commit æ¶ˆæ¯è‹±æ–‡åŒ–æŒ‡å—

## æ¦‚è¿°

æœ¬æŒ‡å—æä¾›å°‡ Git æ­·å²ä¸­çš„ä¸­æ–‡ commit æ¶ˆæ¯è½‰æ›ç‚ºè‹±æ–‡çš„è§£æ±ºæ–¹æ¡ˆã€‚

## âš ï¸ é‡è¦è­¦å‘Š

**åœ¨åŸ·è¡Œä»»ä½•æ“ä½œå‰ï¼Œè«‹ä»”ç´°é–±è®€ä»¥ä¸‹è­¦å‘Šï¼š**

1. **é€™æœƒæ”¹è®Šæ‰€æœ‰ç›¸é—œ commit çš„ hash å€¼**
2. **éœ€è¦ä½¿ç”¨ force push æ›´æ–°é ç¨‹å€‰åº«**
3. **å¦‚æœå…¶ä»–é–‹ç™¼è€…å·²ç¶“åŸºæ–¼é€™äº› commit å·¥ä½œï¼Œæœƒé€ æˆå”ä½œå•é¡Œ**
4. **å»ºè­°åœ¨å€‹äººé …ç›®æˆ–èˆ‡åœ˜éšŠå……åˆ†æºé€šå¾ŒåŸ·è¡Œ**

## æº–å‚™å·¥ä½œ

### 1. ç¢ºä¿å·¥ä½œç›®éŒ„ä¹¾æ·¨

```bash
git status
```

å¦‚æœæœ‰æœªæäº¤çš„è®Šæ›´ï¼Œè«‹å…ˆè™•ç†ï¼š

```bash
git add .
git commit -m "save work in progress"
```

### 2. å‚™ä»½ç•¶å‰å€‰åº«

```bash
# å‰µå»ºæœ¬åœ°å‚™ä»½åˆ†æ”¯
git branch backup-main-$(date +%Y%m%d)

# æˆ–è€…å…‹éš†æ•´å€‹å€‰åº«ä½œç‚ºå‚™ä»½
cd ..
git clone bee_swarm bee_swarm_backup
cd bee_swarm
```

## ä½¿ç”¨æ–¹æ³•

### æ–¹æ³•ä¸€ï¼šè‡ªå‹•æ‰¹é‡é‡å¯«ï¼ˆæ¨è–¦ï¼‰

**é©ç”¨æ–¼ï¼š** å¤§é‡ commit éœ€è¦è™•ç†ï¼Œä¸”ç¿»è­¯æ˜ å°„å·²ç¶“é å®šç¾©

```bash
# é‹è¡Œè‡ªå‹•é‡å¯«è…³æœ¬
./scripts/rewrite-commit-messages.sh
```

é€™å€‹è…³æœ¬æœƒï¼š
- è‡ªå‹•å‰µå»ºå‚™ä»½åˆ†æ”¯
- æ‰¹é‡é‡å¯«æ‰€æœ‰é å®šç¾©çš„ä¸­æ–‡ commit æ¶ˆæ¯
- ä¿ç•™å…¶ä»–æ¶ˆæ¯ä¸è®Š

### æ–¹æ³•äºŒï¼šäº’å‹•å¼è™•ç†

**é©ç”¨æ–¼ï¼š** æƒ³è¦æ›´ç²¾ç¢ºåœ°æ§åˆ¶éç¨‹

```bash
# é‹è¡Œäº’å‹•å¼è…³æœ¬
./scripts/rewrite-commit-messages-interactive.sh
```

é€™å€‹è…³æœ¬æä¾›å››å€‹é¸é …ï¼š
1. **è‡ªå‹•æ‰¹é‡é‡å¯«** - åŸ·è¡Œæ–¹æ³•ä¸€
2. **æ‰‹å‹•é€å€‹é‡å¯«** - ä½¿ç”¨ `git rebase -i` æ‰‹å‹•ç·¨è¼¯
3. **é è¦½æ¨¡å¼** - åªæŸ¥çœ‹å°‡è¦æ”¹è®Šçš„å…§å®¹
4. **å–æ¶ˆæ“ä½œ** - å®‰å…¨é€€å‡º

### æ–¹æ³•ä¸‰ï¼šæ‰‹å‹•ä½¿ç”¨ git rebase

**é©ç”¨æ–¼ï¼š** åªéœ€è¦ä¿®æ”¹å°‘æ•¸å¹¾å€‹ commit

```bash
# å‰µå»ºå‚™ä»½
git branch backup-main-$(date +%Y%m%d)

# é–‹å§‹äº’å‹•å¼ rebaseï¼ˆä¿®æ”¹æœ€è¿‘10å€‹commitï¼‰
git rebase -i HEAD~10
```

åœ¨ç·¨è¼¯å™¨ä¸­ï¼š
1. å°‡è¦ä¿®æ”¹çš„ commit å‰çš„ `pick` æ”¹ç‚º `reword`
2. ä¿å­˜ä¸¦é—œé–‰ç·¨è¼¯å™¨
3. ç‚ºæ¯å€‹æ¨™è¨˜çš„ commit é‡æ–°ç·¨å¯«æ¶ˆæ¯

## ç•¶å‰æ”¯æŒçš„ç¿»è­¯æ˜ å°„

è…³æœ¬ç›®å‰æ”¯æŒä»¥ä¸‹ä¸­æ–‡æ¶ˆæ¯çš„è‡ªå‹•ç¿»è­¯ï¼š

| ä¸­æ–‡åŸæ–‡ | è‹±æ–‡ç¿»è­¯ |
|---------|---------|
| `docs: æ›´æ–°CHANGELOGè¨˜éŒ„æ–‡ä»¶åè‹±æ–‡åŒ–è®Šæ›´` | `docs: update CHANGELOG for filename internationalization changes` |
| `refactor: æ–‡ä»¶åè‹±æ–‡åŒ–å’Œè§’è‰²ç³»çµ±æ›´æ–°` | `refactor: internationalize filenames and update role system` |
| `ğŸ§¹ å®Œæˆé …ç›®é‡æ§‹æœ€çµ‚æ¸…ç†å’Œå„ªåŒ–` | `chore: complete project restructuring final cleanup and optimization` |
| `docs(translation): å®ŒæˆBee Swarmé …ç›®å®Œæ•´è‹±æ–‡ç¿»è­¯` | `docs(translation): complete English translation for Bee Swarm project` |
| ... | *æ›´å¤šæ˜ å°„è«‹æŸ¥çœ‹è…³æœ¬æ–‡ä»¶* |

## åŸ·è¡Œå¾Œæ“ä½œ

### 1. æª¢æŸ¥çµæœ

```bash
# æŸ¥çœ‹é‡å¯«å¾Œçš„ commit æ­·å²
git log --oneline -n 20

# æ¯”è¼ƒå·®ç•°
git log --oneline backup-main-$(date +%Y%m%d)..HEAD
```

### 2. æ¨é€åˆ°é ç¨‹å€‰åº«

**å¦‚æœæ»¿æ„é‡å¯«çµæœï¼š**

```bash
# ä½¿ç”¨ force-with-lease å®‰å…¨æ¨é€
git push --force-with-lease origin main
```

**`--force-with-lease` æ¯” `--force` æ›´å®‰å…¨ï¼Œæœƒæª¢æŸ¥é ç¨‹åˆ†æ”¯æ˜¯å¦æœ‰å…¶ä»–äººçš„æäº¤**

### 3. å¦‚æœéœ€è¦å›æ»¾

```bash
# å›æ»¾åˆ°å‚™ä»½åˆ†æ”¯
git reset --hard backup-main-$(date +%Y%m%d)

# å¦‚æœå·²ç¶“æ¨é€ï¼Œéœ€è¦ force push å›æ»¾
git push --force-with-lease origin main
```

## å”ä½œæ³¨æ„äº‹é …

### é€šçŸ¥åœ˜éšŠæˆå“¡

å¦‚æœæ˜¯åœ˜éšŠé …ç›®ï¼Œè«‹åœ¨åŸ·è¡Œå‰é€šçŸ¥æ‰€æœ‰æˆå“¡ï¼š

```bash
# ç™¼é€é€šçŸ¥æ¶ˆæ¯ç¤ºä¾‹
echo "è¨ˆåŠƒæ–¼ $(date) é‡å¯« Git æ­·å²ä¸­çš„ä¸­æ–‡ commit æ¶ˆæ¯ç‚ºè‹±æ–‡ã€‚
é€™æœƒæ”¹è®Šæ‰€æœ‰ commit hashã€‚
è«‹ç¢ºä¿åœ¨æ­¤æ™‚é–“å‰æ¨é€æ‰€æœ‰æœ¬åœ°è®Šæ›´ï¼Œä¸¦åœ¨æ“ä½œå®Œæˆå¾Œé‡æ–°å…‹éš†å€‰åº«ã€‚"
```

### åœ˜éšŠæˆå“¡éœ€è¦çš„æ“ä½œ

**æ“ä½œå®Œæˆå¾Œï¼Œå…¶ä»–é–‹ç™¼è€…éœ€è¦ï¼š**

```bash
# åˆªé™¤æœ¬åœ°åˆ†æ”¯ä¸¦é‡æ–°ç²å–
git fetch origin
git reset --hard origin/main

# æˆ–è€…é‡æ–°å…‹éš†å€‰åº«
cd ..
rm -rf bee_swarm
git clone <repository-url> bee_swarm
```

## æ•…éšœæ’é™¤

### å¦‚æœ filter-branch å¤±æ•—

```bash
# æ¸…ç† filter-branch æ®˜ç•™æ–‡ä»¶
rm -rf .git/refs/original/
git reflog expire --expire=now --all
git gc --prune=now --aggressive
```

### å¦‚æœéœ€è¦æ·»åŠ æ–°çš„ç¿»è­¯æ˜ å°„

ç·¨è¼¯ `scripts/rewrite-commit-messages.sh`ï¼Œåœ¨ case èªå¥ä¸­æ·»åŠ æ–°çš„æ˜ å°„ï¼š

```bash
"ä½ çš„ä¸­æ–‡æ¶ˆæ¯")
    echo "Your English message"
    ;;
```

## æœ€ä½³å¯¦è¸

1. **æ¸¬è©¦å…ˆè¡Œ**ï¼šåœ¨æ¸¬è©¦åˆ†æ”¯ä¸Šå…ˆè©¦é‹è¡Œ
2. **å°æ‰¹æ¬¡è™•ç†**ï¼šå¦‚æœæ­·å²å¾ˆé•·ï¼Œè€ƒæ…®åˆ†æ‰¹è™•ç†
3. **æ–‡æª”è¨˜éŒ„**ï¼šåœ¨ CHANGELOG ä¸­è¨˜éŒ„é€™æ¬¡æ­·å²é‡å¯«
4. **åœ˜éšŠæºé€š**ï¼šç¢ºä¿æ‰€æœ‰ç›¸é—œäººå“¡éƒ½äº†è§£è®Šæ›´

## ç›¸é—œå‘½ä»¤åƒè€ƒ

```bash
# æŸ¥çœ‹æ‰€æœ‰åŒ…å«ä¸­æ–‡çš„ commit
git log --grep="[\u4e00-\u9fff]" --oneline

# æŸ¥çœ‹æœ€è¿‘çš„ commit æ¶ˆæ¯
git log --pretty=format:"%s" -n 20

# å¼·åˆ¶åƒåœ¾å›æ”¶
git gc --prune=now --aggressive

# æŸ¥çœ‹åˆ†æ”¯æ­·å²
git log --graph --oneline --all
``` 